# Análise de Incidente: Ataque via Vulnerabilidade SAP (CVE-2025-31324) e Implantação do Malware 'Auto-Color'

**Data de Publicação:** 31 de julho de 2025  
**Nível de Ameaça:** Crítico 9.8 - 10.0 
**Autor:** Patrícia Canossa (com base em relatórios da Darktrace e Palo Alto Networks)

---

### 1. Resumo Executivo

Em abril de 2025, foi identificado um ciberataque sofisticado explorando uma vulnerabilidade crítica em sistemas SAP NetWeaver para comprometer servidores Linux. O ataque resultou na implantação de um Trojan de Acesso Remoto (RAT) conhecido como 'Auto-Color'. Este documento detalha a organização afetada, a vulnerabilidade explorada, a metodologia do ataque e as especificidades do CVE, servindo como um recurso técnico para a compreensão e mitigação de ameaças semelhantes.

### 2. Organização Afetada e Alvo

* **Setor:** Químico
* **Localização:** Estados Unidos
* **Alvo Principal:** Servidores de aplicação SAP rodando em ambiente Linux e expostos à internet.

O incidente, analisado pela empresa de cibersegurança Darktrace, destacou-se pela precisão e conhecimento técnico dos atacantes sobre o ambiente da vítima. Investigações anteriores sobre o malware 'Auto-Color' indicam que o mesmo grupo pode ter como alvo outras instituições, incluindo universidades e organizações governamentais na América do Norte e Ásia.

### 3. Vulnerabilidade Explorada: CVE-2025-31324

* **Identificador:** `CVE-2025-31324`
* **Sistema Afetado:** SAP NetWeaver
* **Tipo de Falha (CWE-434):** Upload de Arquivo Não Autenticado (*Unrestricted File Upload*)
* **Impacto:** Execução Remota de Código (RCE - *Remote Code Execution*)
* **Status da Correção:** Patch liberado pela SAP em abril de 2025.

#### Detalhamento Técnico do CVE-2025-31324

A vulnerabilidade `CVE-2025-31324` reside em um componente do SAP NetWeaver que gerencia o upload de arquivos. A falha permite que um atacante remoto, sem a necessidade de credenciais de acesso (não autenticado), envie um arquivo malicioso para o servidor.

O problema central é a validação inadequada do tipo e conteúdo do arquivo enviado. Por exemplo, a aplicação pode não verificar corretamente a extensão ou o `MIME type` do arquivo, permitindo que um script executável (como um arquivo `.jsp`, `.php` ou, neste caso, um binário ELF) seja carregado para um diretório acessível pela web no servidor.

Uma vez que o arquivo malicioso está hospedado no servidor, o atacante pode simplesmente acessá-lo através de uma URL pública, o que dispara sua execução no contexto do usuário do serviço SAP. Isso concede ao invasor um ponto de entrada para executar comandos arbitrários no sistema operacional subjacente (Linux, neste caso), caracterizando uma falha de Execução Remota de Código.

### 4. Metodologia do Ataque (Cadeia de Ataque)

O ataque, observado pela Darktrace, seguiu uma sequência clara de ações, demonstrando planejamento e contenção calculada.

**Fase 1: Reconhecimento e Varredura (Aproximadamente T-72 horas)**
* O atacante iniciou uma varredura (*scanning*) na rede da vítima, identificando sistemas expostos à internet.
* O foco foi em servidores que executavam o serviço SAP NetWeaver, provavelmente utilizando *fingerprinting* de serviços para localizar instâncias vulneráveis à `CVE-2025-31324`.

**Fase 2: Exploração e Ponto de Entrada (28 de Abril)**
* O atacante explorou a vulnerabilidade `CVE-2025-31324` para realizar o upload de um arquivo malicioso no servidor SAP vulnerável.
* O arquivo carregado era um binário executável no formato ELF (Executable and Linkable Format), o padrão para sistemas Linux. Este binário é o malware 'Auto-Color'.

**Fase 3: Execução e Comprometimento (Pós-Exploração)**
* Após o upload bem-sucedido, o atacante acionou a execução do binário ELF no servidor comprometido.
* O malware 'Auto-Color' foi então executado, iniciando suas operações no sistema da vítima.

**Fase 4: Comando e Controle (C2)**
* O 'Auto-Color' tentou estabelecer comunicação com seu servidor de Comando e Controle (C2) externo.
* **Ponto Crucial:** Neste incidente específico, a comunicação com o C2 falhou. A falha na conexão ativou uma das características mais perigosas do malware: seu modo de evasão. Como não conseguiu se conectar ao C2, o malware permaneceu dormente e ocultou suas funcionalidades maliciosas para evitar a detecção por ferramentas de segurança automatizadas.

### 5. Análise do Malware: 'Auto-Color' RAT

O 'Auto-Color' é um Trojan de Acesso Remoto (RAT) projetado especificamente para sistemas Linux. Sua arquitetura demonstra um profundo conhecimento do sistema operacional.

**Principais Funcionalidades:**

* **Shell Reverso:** Cria uma conexão de volta para o servidor do atacante, fornecendo um terminal de comando interativo e controle total sobre o sistema.
* **Downloader/Executor:** Capaz de baixar, criar e executar outros arquivos e malwares no sistema comprometido, permitindo a instalação de ferramentas adicionais.
* **Manipulação de Proxy:** Altera as configurações de proxy do sistema para redirecionar o tráfego de rede, potencialmente para interceptar dados ou burlar firewalls.
* **Coleta de Informações (*Profiling*):** Realiza um levantamento detalhado do sistema, coletando informações como versão do kernel, hardware, usuários e configurações de rede.
* **Mecanismo de Evasão:** Como observado, se a conexão C2 falha, o malware oculta seu comportamento malicioso, aparecendo como um processo benigno.
* **Autodestruição (*Kill Switch*):** Possui uma função para apagar todos os seus vestígios do sistema (arquivos, processos e logs), dificultando a análise forense pós-incidente.

### 6. Mitigação e Recomendações

1.  **Aplicação de Patches:** A recomendação mais crítica é a aplicação imediata da correção para a `CVE-2025-31324` fornecida pela SAP em todos os sistemas NetWeaver.
2.  **Monitoramento de Rede:** Implementar monitoramento contínuo do tráfego de rede para identificar atividades suspeitas, como varreduras em portas SAP, downloads de binários ELF em servidores web e comunicações com endereços IP desconhecidos ou maliciosos.
3.  **Segurança de Endpoints (EDR):** Utilizar soluções de Detecção e Resposta de Endpoint (EDR) em servidores Linux para detectar e bloquear a execução de binários não autorizados e comportamentos anômalos de processos.
4.  **Princípio do Menor Privilégio:** Garantir que os serviços web, como o SAP NetWeaver, rodem com os privilégios mínimos necessários para sua operação, limitando o impacto de uma possível execução de código.
5.  **Firewall de Aplicação Web (WAF):** Configurar um WAF para inspecionar uploads de arquivos, bloqueando tipos de arquivo executáveis e potencialmente perigosos antes que cheguem ao servidor.